<Window x:Class="TRPGLogArrangeTool.SelectImageWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:TRPGLogArrangeTool"
        Title="画像選択" Height="480" Width="440" 
        WindowStartupLocation="CenterOwner"
        WindowStyle="None"
        AllowDrop="True"
        DragOver="Window_DragOver"
        Drop="Window_Drop" ResizeMode="NoResize">

    <Window.Resources>
        <local:ImageKeyToBitmapConverter x:Key="ImageKeyToBitmapConverter"/>
        <local:ZeroToVisibilityConverter x:Key="ZeroToVisibilityConverter"/>        
    </Window.Resources>
    <Grid ToolTip="画像はドラッグアンドドロップで追加できます">
        <Grid.ContextMenu>
            <ContextMenu>
                <MenuItem x:Name="AddImageContext" Header="画像追加" Click="AddImageContext_Click"/>
            </ContextMenu>
        </Grid.ContextMenu>
        <Grid x:Name="OverlayPanel"
              VerticalAlignment="Stretch"
              HorizontalAlignment="Stretch"
              Background="#80000000"
              Visibility="Collapsed"
              Panel.ZIndex="999"/>
        <Grid Width="32" Height="32" VerticalAlignment="Top" HorizontalAlignment="Right" Margin="0,0,20,0" Panel.ZIndex="999"
              MouseLeftButtonUp="CloseButton_MouseLeftButtonUp">
            <Ellipse Fill="Red"/>
            <Image x:Name="CloseButton" Source="/resource/細いバツのアイコン.png" Height="16" Width="16" HorizontalAlignment="Center" VerticalAlignment="Center"/>
        </Grid>
        <ScrollViewer>
            <WrapPanel Margin="10">
                <ItemsControl ItemsSource="{Binding ImageKeys}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel IsItemsHost="True" Margin="10"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border BorderThickness="1" BorderBrush="Gray" Margin="5">
                                <Image Source="{Binding Converter={StaticResource ImageKeyToBitmapConverter}}"
                                       Width="100" Height="100"
                                       Stretch="UniformToFill"
                                       MouseLeftButtonUp="Image_MouseLeftButtonUp"
                                       MouseRightButtonUp="Image_MouseRightButtonUp"
                                       ToolTip="右クリックで拡大プレビューできます"/>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </WrapPanel>
        </ScrollViewer>
        <TextBlock Text="まだ画像がありません"
                   Foreground="Gray"
                   FontStyle="Italic"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center"
                   FontSize="16"
                   Visibility="{Binding ImageKeys.Count, Converter={StaticResource ZeroToVisibilityConverter}}"/>
    </Grid>
</Window>
